<div
    class="flex flex-align-center table-filter-item"
    cdkOverlayOrigin
    #filterMenu="cdkOverlayOrigin"
>
    <div (click)="toggleFilterMenu()">
        <span class="tfi-name"> {{ category }}:&nbsp;</span>

        <span class="tfi-value">
            <ng-container *ngIf="appliedItems.length === 1; else moreFilters">
                {{ appliedItems[0].name }}
            </ng-container>

            <ng-template #moreFilters> {{ appliedItems.length }} Selected </ng-template>
        </span>
    </div>
    <mat-icon class="tfi-close-icon" (click)="clearFilter.emit(category)">close</mat-icon>
</div>

<ng-template
    cdkConnectedOverlay
    [cdkConnectedOverlayOrigin]="filterMenu"
    [cdkConnectedOverlayOpen]="isFilterMenuShown"
    (overlayOutsideClick)="isFilterMenuShown = false"
    (overlayKeydown)="overlayKeyDown($event)"
>
    <ul class="filter-item-menu mat-elevation-z4">
        <li>
            <app-table-filter-search [(text)]="filterOptionQuery"></app-table-filter-search>
        </li>
        <li *ngFor="let option of filterOptionsByQuery()">
            <mat-checkbox
                [checked]="appliedFilters[option]"
                (change)="updateFilterOption(option, $event.checked)"
            >
                {{ option }}
            </mat-checkbox>
        </li>
    </ul>
</ng-template>
